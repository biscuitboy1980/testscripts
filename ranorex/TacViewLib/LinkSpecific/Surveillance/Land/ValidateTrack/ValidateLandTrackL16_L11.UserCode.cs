///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.Drawing;
using System.Threading;
using System.Windows.Forms;

using Ranorex;
using Ranorex.Core;

using CommonUtilLib;

namespace TacViewLib.LinkSpecific.Surveillance.Land.ValidateTrack
{
    public partial class ValidateLandTrackL16_L11
 	{
		public static bool ZoomFlag = false;		
		public static string TrackNum;		
		
		//Basic Info
		public static string Ind;
		public static string ID;
		public static string Plat;
		public static string L11Point;
		public static string L11PointAmp;
		public static string L16ID;
		public static string L16Plat;
		public static string L16PointType;		
	
		//Out of Range Flags
		public static bool Ind_OOR;
		public static bool ID_OOR;
		public static bool Plat_OOR;
		
		//Other		
		public static bool Link11 = false;	
		public static string TypeFlag;
				
		//************************************************************************************//
		//*******************************Right Clicks on Track********************************//
		//************************************************************************************//		
		
		public void RightClickTrack()
		{			
			Duration OrigDur = repo.FormTacViewC2.PictureTrackInfo.SearchTimeout;
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = 2000;			
			
			if (repo.FormTacViewC2.PictureTrackInfo.Exists())
			{
				Report.Info("Mouse Right Click item 'FormTacViewC2.PictureTrack' at Center.");
				repo.FormTacViewC2.PictureTrack.Click(MouseButtons.Right);
			}
			else
			{
				ZoomFlag = true;
				Report.Info("Track # " + TrackNum + " not found on the current display, going to world wide view");
				Report.Screenshot();
				repo.FormTacViewC2.ButtonZoom_Out_Max.Click();
				
				if (repo.FormTacViewC2.PictureTrackInfo.Exists())
				{
					Report.Info("Mouse Right Click item 'FormTacViewC2.PictureTrack' at Center.");
					repo.FormTacViewC2.PictureTrack.Click(MouseButtons.Right);
				}
				else
				{
					Report.Error("Unable to find Track # " + TrackNum + " anywhere in the world");
					Report.Screenshot();
					return;
				}				
			}
			
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = OrigDur;
		}		

		//************************************************************************************//
		//********************Opens Track Dialog For Corresponding Track**********************//
		//************************************************************************************//
		
		public void ViewTrackProperties()
		{			
			Duration OrigDur = repo.FormRealView.MenuItemTracksInfo.SearchTimeout;
			repo.FormRealView.MenuItemTracksInfo.SearchTimeout = 1000;
			Duration OrigDur1 = repo.FormRealView.MenuItemTrackNumber2Info.SearchTimeout;
			repo.FormRealView.MenuItemTrackNumber2Info.SearchTimeout = 1000;			
			
			if (repo.FormRealView.MenuItemTracksInfo.Exists())
			{
				Report.Info("Mouse Left Click item 'FormRealView.MenuItemTracks'");
			    repo.FormRealView.MenuItemTracks.Click();
			    Report.Info("Mouse Left Click item 'FormTracks.MenuItemC2_HOST_2_Track'");
		        repo.FormTracks.MenuItemConnection2_Track.Click();
		       	Report.Info("Mouse Left Click item 'FormTOAD2.MenuItemTrack_Properties");
				repo.FormConnection2.MenuItemTrack_Properties.Click();
			}			
			else if (repo.FormRealView.MenuItemTrackNumber2Info.Exists())
			{
			    Report.Info("Mouse Left Click item 'repo.FormRealView.MenuItemTrackNumber2'");
		        repo.FormRealView.MenuItemTrackNumber2.Click();
		       	Report.Info("Mouse Left Click item 'FormTOAD2.MenuItemTrack_Properties");
				repo.FormConnection2.MenuItemTrack_Properties.Click();
			}
			
			repo.FormRealView.MenuItemTracksInfo.SearchTimeout = OrigDur;
			repo.FormRealView.MenuItemTrackNumber2Info.SearchTimeout = OrigDur1;
		}
		
		//************************************************************************************//
		//****************************Validates Source Type Value*****************************//
		//************************************************************************************//
		
		public void ValidateSourceType()
		{
			string SrcValue;
			
			Duration OrigDur = repo.FormMain__Land_Point_Track_TN.SelfInfo.SearchTimeout;
			repo.FormMain__Land_Point_Track_TN.SelfInfo.SearchTimeout = 500;	
			
			if (repo.FormMain__Land_Point_Track_TN.SelfInfo.Exists())
			{
				Accessible accElement = new Accessible(repo.FormMain__Land_Point_Track_TN.ListItemSource_Type);  
				SrcValue = accElement.Value;
				TypeFlag = "Land";
			}
			else
			{
				Accessible accElement = new Accessible(repo.FormMain__Reference_Point_TN.ListItemSource_Type);  
				SrcValue = accElement.Value;
				TypeFlag = "Reference";
			}	
			
		 	if (SrcValue == "TADIL A" || SrcValue == "TADIL B")
	  		{
		   		Link11 = true;
		   		Report.Info("Link 11 Track Detected. Validating Link 11 Values");
		   	}
		   	else
		   	{
		   		Link11 = false;
		   		Report.Info("Link 16 Track Detected. Validating Link 16 Values");
		   	}
		   	
		   	repo.FormMain__Land_Point_Track_TN.SelfInfo.SearchTimeout = OrigDur;
		}	
		
		//************************************************************************************//
		//******************Validates Land ID, Platform, and Activity Value*******************//
		//************************************************************************************//
				
		public void ValidateLand()
		{
			if (!ID_OOR && !Plat_OOR)
			{
					CommonUtilLib.Forwarding ForwardingFunctions = new CommonUtilLib.Forwarding();
					ForwardingFunctions.Convert_LandL16_L11(ID, Plat, out L11Point, out L11PointAmp);					
					Report.Info("Link 16 Identity Value Entered = " + ID);
					Report.Info("Link 16 Platform Value Entered = " + Plat);
					
					Report.Info("Link 11 Point Value = " + L11Point);
					Report.Info("Link 11 Point Amplification Value = " + L11PointAmp);
				
				if (Link11 == true)
				{									
					Report.Info("Validating AttributeEqual (Text='(Point)') on item 'repo.FormMain__Land_Point_Track_TN.ListItemPointInfo'.");
					Validate.Attribute(repo.FormMain__Land_Point_Track_TN.ListItemPointInfo, "AccessibleValue", L11Point, Validate.DefaultMessage, false);
					Report.Info("Validating AttributeEqual (Text=' (Pri Amp)') on item 'repo.FormMain__Land_Point_Track_TN.ListItemPointAmplificationInfo'.");
					Validate.Attribute(repo.FormMain__Land_Point_Track_TN.ListItemPointAmplificationInfo, "AccessibleValue", L11PointAmp, Validate.DefaultMessage, false);
				}
				else
				{
					CommonUtilLib.Forwarding ForwardingFunctions1 = new CommonUtilLib.Forwarding();
					ForwardingFunctions1.Convert_LandL11_L16(L11Point, L11PointAmp, out L16ID, out L16Plat, out L16PointType);	
					if (L16PointType != null)
					{
						Report.Info("Validating AttributeEqual (Text='(Point Type)') on item 'repo.FormMain__Reference_Point_TN.ListItemPoint_TypeInfo'.");
						Validate.Attribute(repo.FormMain__Reference_Point_TN.ListItemPoint_TypeInfo, "AccessibleValue", L16PointType, Validate.DefaultMessage, false);
						Report.Info("Validating AttributeEqual (Text='(Amplification)') on item 'repo.FormMain__Reference_Point_TN.ListItemAmplificationInfo'.");
						Validate.Attribute(repo.FormMain__Reference_Point_TN.ListItemAmplificationInfo, "AccessibleValue", "N.S.", Validate.DefaultMessage, false);
					}
					else
					{
						Report.Info("Validating AttributeEqual (Text='(ID)') on item 'repo.FormMain__Land_Point_Track_TN.ListItemIdentityInfo'.");
						Validate.Attribute(repo.FormMain__Land_Point_Track_TN.ListItemIdentityInfo, "AccessibleValue", L16ID, Validate.DefaultMessage, false);
						Report.Info("Validating AttributeEqual (Text='(Platform)') on item 'repo.FormMain__Land_Point_Track_TN.ListItemPlatformInfo'.");
						Validate.Attribute(repo.FormMain__Land_Point_Track_TN.ListItemPlatformInfo, "AccessibleValue", L16Plat, Validate.DefaultMessage, false);
					}
				}
			}
		}		
		
		//************************************************************************************//
		//*******************************Closes Track Dialog**********************************//
		//************************************************************************************//
		
		 public void Close_Dialog()
        {
            if (TypeFlag == "Land")
		 	{
            	repo.FormMain__Land_Point_Track_TN.ButtonCLOSE.Click(250);
		 	}
		 	else
		 	{
		 		repo.FormMain__Reference_Point_TN.ButtonCLOSE.Click(250);
		 	}
        }
		
		//************************************************************************************//
		//****************************Drops Corresponding Track*******************************//
		//************************************************************************************//
		
		public void DropTrack()
		{			
			Drop_Track.DropTrack.Start();
		}

		//************************************************************************************//
		//***************************Validates Track is Dropped*******************************//
		//************************************************************************************//
		
		public void Validate_DropTrack()
		{
			Duration OrigDur = repo.FormTacViewC2.PictureTrackInfo.SearchTimeout;
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = 8000;
			
			Report.Info("Validating Track #" + TrackNum + " was dropped");
	
			bool result = Validate.NotExists(repo.FormTacViewC2.PictureTrackInfo, Validate.DefaultMessage, false);			
			
			if (result == true)
			{
				Report.Success("Successfully dropped track #" + TrackNum);
			}
			else
			{
				Report.Debug("Track #" + TrackNum + " failed to drop within 8 seconds, proceeding to next track creation.");
				Report.Screenshot();				
			}
			
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = OrigDur;
		}		
		
		//************************************************************************************//
		//*****************************Zooms Out to Locate Track******************************//
		//************************************************************************************//	
		
		public void Zoom500()
		{
			if (ZoomFlag == true)
			{
				Report.Info("Mouse Left Click item 'FormTacViewC2.ButtonSet_Range_to_500_km' at Center.");
				repo.FormTacViewC2.ButtonSet_Range_to_500_km.Click();
				Report.Info("Mouse Left Click item 'FormTacViewC2.Button_Center_on_Own_Site' at Center.");
				repo.FormTacViewC2.Button_Center_on_Own_Site.Click();
				ZoomFlag = false;
			}
		}

		//**************************************************************************************//
		//*****************************Ranorex Generated Init Method****************************//
		//**************************************************************************************//
		
		private void Init()
		{
			// Your recording specific initialization code goes here.
		}

		//************************************************************************************//
		//*****************************Sets Track Number in Repo******************************//
		//************************************************************************************//
		
		public void SetTrackNumberInRepo()
		{
			tracknumber = TrackNum;	
			Report.Info("Setting tracknumber to " + tracknumber);
		}
		
		//**************************************************************************************//
		//***************************Ranorex Generated Default Method***************************//
		//**************************************************************************************//
		
        public void ValidateTrackType()
        {
            // Your code goes here. Code inside this method will not be changed by the code generator.
            
        }

        public void ValidateInd()
        {
            // Your code goes here. Code inside this method will not be changed by the code generator.
            
        }
	}
}