///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.Drawing;
using System.Threading;
using System.Windows.Forms;

using Ranorex;
using Ranorex.Core;
using Ranorex.Core.Testing;

namespace TacViewLib.LinkSpecific.Surveillance.Reference.ValidateTrack
{
    public partial class DropSpaceTrackRegression
    {		
		public static bool ZoomFlag = false;		
		public static string SpcTrackNum;
		
		public void DropTrack()
		{
			Drop_Track.DropTrack.TrackNum = SpcTrackNum;
			Drop_Track.DropTrack.Start();
		}

		public void Validate_DropTrack()
		{
			Duration OrigDur = repo.FormTacViewC2.PictureTrackInfo.SearchTimeout;
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = 8000;

			Report.Info("Validating Track #" + SpcTrackNum + " was dropped");
	
			bool result = Validate.NotExists(repo.FormTacViewC2.PictureTrackInfo, Validate.DefaultMessage, false);
			
			if (result == true)
			{
				Report.Success("Successfully dropped track #" + SpcTrackNum);
			}
			else
			{
				Report.Debug("Track #" + SpcTrackNum + " failed to drop within 8 seconds, proceeding to next track creation.");
				Report.Screenshot();				
			}
			
			repo.FormTacViewC2.PictureTrackInfo.SearchTimeout = OrigDur;
		}	
		
		public void RightClickTrack()
		{			
			Duration OrigDur = repo.FormTacViewC2.PictureSpaceTrackInfo.SearchTimeout;
			repo.FormTacViewC2.PictureSpaceTrackInfo.SearchTimeout = 2000;			
			
			if (repo.FormTacViewC2.PictureSpaceTrackInfo.Exists())
			{
				Report.Info("Mouse Right Click item 'FormTacViewC2.PictureSpaceTrack' at Center.");
				repo.FormTacViewC2.PictureSpaceTrack.Click(MouseButtons.Right);
			}
			else
			{
				ZoomFlag = true;
				Report.Info("Track # " + SpcTrackNum + " not found on the current display, going to world wide view");
				repo.FormTacViewC2.ButtonZoom_Out_Max.Click();
				
				if (repo.FormTacViewC2.PictureSpaceTrackInfo.Exists())
				{
					Report.Info("Mouse Right Click item 'FormTacViewC2.PictureSpaceTrack' at Center.");
					repo.FormTacViewC2.PictureSpaceTrack.Click(MouseButtons.Right);
				}
				else
				{
					Report.Error("Unable to find Track # " + SpcTrackNum + " anywhere in the world");
					return;
				}
				
			}
			
			repo.FormTacViewC2.PictureSpaceTrackInfo.SearchTimeout = OrigDur;
		}
		
		public void Zoom500()
		{
			if (ZoomFlag == true)
			{
			Report.Info("Mouse Left Click item 'FormTacViewC2.ButtonSet_Range_to_500_km' at Center.");
			repo.FormTacViewC2.ButtonSet_Range_to_500_km.Click();
			Report.Info("Mouse Left Click item 'FormTacViewC2.Button_Center_on_Own_Site' at Center.");
			repo.FormTacViewC2.Button_Center_on_Own_Site.Click();
			ZoomFlag = false;
			}
		}

		private void Init()
		{
			// Your recording specific initialization code goes here.
		}		
		
		public void SetTrackNumberInRepo()
		{
			spacetracknumber = SpcTrackNum;	
			Report.Info("setting tracknumber to " + spacetracknumber);
		}		
	}
}
